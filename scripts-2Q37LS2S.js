try{window.AudioContext=window.AudioContext||window.webkitAudioContext,window.audioContext=new window.AudioContext}catch{console.log("No Web Audio API support")}var WebAudioAPISoundManager=function(n){this.context=n,this.bufferList={},this.playingSounds={}};WebAudioAPISoundManager.prototype={addSound:function(n){var t=new XMLHttpRequest;t.open("GET",n,!0),t.responseType="arraybuffer";var e=this;t.onload=function(){e.context.decodeAudioData(t.response,function(o){if(!o){alert("error decoding file data: "+n);return}e.bufferList[n]=o})},t.onerror=function(){alert("BufferLoader: XHR error")},t.send()},stopSoundWithUrl:function(n){if(this.playingSounds.hasOwnProperty(n))for(var t in this.playingSounds[n])this.playingSounds[n].hasOwnProperty(t)&&this.playingSounds[n][t].noteOff(0)}};var WebAudioAPISound=function(n,t){this.settings={loop:!1};for(var e in t)t.hasOwnProperty(e)&&(this.settings[e]=t[e]);this.url=n+".mp3",window.webAudioAPISoundManager=window.webAudioAPISoundManager||new WebAudioAPISoundManager(window.audioContext),this.manager=window.webAudioAPISoundManager,this.manager.addSound(this.url)};WebAudioAPISound.prototype={play:function(){var n=this.manager.bufferList[this.url];if(typeof n<"u"){var t=this.makeSource(n);t.loop=this.settings.loop,t.noteOn(0),this.manager.playingSounds.hasOwnProperty(this.url)||(this.manager.playingSounds[this.url]=[]),this.manager.playingSounds[this.url].push(t)}},stop:function(){this.manager.stopSoundWithUrl(this.url)},getVolume:function(){return this.translateVolume(this.volume,!0)},setVolume:function(n){this.volume=this.translateVolume(n)},translateVolume:function(n,t){return t?n*100:n/100},makeSource:function(n){var t=this.manager.context.createBufferSource(),e=this.manager.context.createGainNode();return e.gain.value=this.volume,t.buffer=n,t.connect(e),e.connect(this.manager.context.destination),t}};
